BEGIN ~JA#PIRA1~
// END JA#PIRA1


CHAIN IF ~NumberOfTimesTalkedTo(0)~ THEN JA#PIRA1 JA#PIRA1_00
  @0 = @1
  == %SAFANA_JOINED% IF ~InParty("SAFANA") InMyArea("SAFANA") !StateCheck("SAFANA",CD_STATE_NOTVALID)~ THEN @12
  == JA#PIRA1 @2 = @3 = @4 = @0 = @1
  == %SAFANA_JOINED% IF ~InParty("SAFANA") InMyArea("SAFANA") !StateCheck("SAFANA",CD_STATE_NOTVALID)~ THEN @13
  == JA#PIRA1 @2 = @3 = @4
END
  IF ~~ THEN REPLY @5 GOTO JA#PIRA1_10
  IF ~~ THEN REPLY @6 GOTO JA#PIRA1_10
  IF ~~ THEN REPLY @7 GOTO JA#PIRA1_11


APPEND JA#PIRA1

IF ~~ THEN JA#PIRA1_10
  SAY @8
  IF ~~ THEN GOTO JA#PIRA1_12
END

IF ~~ THEN JA#PIRA1_11
  SAY @9
  IF ~~ THEN GOTO JA#PIRA1_12
END

END // APPEND JA#PIRA1


CHAIN JA#PIRA1 JA#PIRA1_12
  @2 = @10 = @2 = @11 DO ~Enemy() Attack(NearestEnemyOf(Myself))~
  == %IMOEN_JOINED% IF ~InParty("IMOEN2") InMyArea("IMOEN2") !StateCheck("IMOEN2",CD_STATE_NOTVALID)~ THEN @14
EXIT
